<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}MV+{% endblock %}</title>
    <link rel="icon" type="image/x-icon" href="{{ url_for('static', filename='favicon.ico') }}">
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="SPAD for Vision - Spatiotemporal Detection & Material Classification by Deborah Akuoko Ewurama Minka, The University of Edinburgh. Computer vision research using SPAD sensors, single photon avalanche diode, machine vision, and machine intelligence.">
    <meta name="keywords" content="Deborah Akuoko, Deborah Akuoko Ewurama Minka, Edinburgh University, SPAD sensors, single photon avalanche diode, machine vision, computer vision, machine intelligence, artificial intelligence, spatiotemporal detection, material classification, object detection, YOLOv3, YOLOv8, DINOv3, PyTorch, deep learning">
    <meta name="author" content="Deborah Akuoko Ewurama Minka">
    <meta name="institution" content="The University of Edinburgh">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website">
    <meta property="og:title" content="SPAD for Vision - Deborah Akuoko Ewurama Minka | Edinburgh University">
    <meta property="og:description" content="Computer vision research using SPAD sensors, single photon avalanche diode, machine vision, and machine intelligence. Spatiotemporal detection and material classification.">
    <meta property="og:site_name" content="SPAD for Vision">
    
    <!-- Twitter -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="SPAD for Vision - Deborah Akuoko Ewurama Minka | Edinburgh University">
    <meta name="twitter:description" content="Computer vision research using SPAD sensors, single photon avalanche diode, machine vision, and machine intelligence.">
    
    <!-- Structured Data for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "SoftwareApplication",
      "name": "SPAD for Vision",
      "description": "Spatiotemporal Detection & Material Classification using SPAD sensors and computer vision",
      "applicationCategory": "Research Software",
      "author": {
        "@type": "Person",
        "name": "Deborah Akuoko Ewurama Minka",
        "affiliation": {
          "@type": "Organization",
          "name": "The University of Edinburgh"
        }
      },
      "keywords": "Deborah Akuoko, Deborah Akuoko Ewurama Minka, Edinburgh University, SPAD sensors, single photon avalanche diode, machine vision, computer vision, machine intelligence, artificial intelligence, spatiotemporal detection, material classification"
    }
    </script>
    
    <!-- Critical inline CSS to prevent white flash - MUST be first -->
    <style>
        /* Prevent FOUC (Flash of Unstyled Content) - Maximum aggressive approach */
        html, body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0d1b1b 100%) !important;
            background-color: #0a0a0a !important;
            margin: 0 !important;
            padding: 0 !important;
            width: 100% !important;
            height: 100% !important;
        }
        html {
            overflow-x: hidden;
        }
        body {
            color: #ffffff;
            font-family: 'Times New Roman', serif;
            min-height: 100vh;
            visibility: hidden;
            opacity: 0;
        }
        body.loaded {
            visibility: visible;
            opacity: 1;
            transition: opacity 0.1s ease-in;
        }
        #app {
            min-height: 100vh;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 50%, #0d1b1b 100%);
            background-color: #0a0a0a;
        }
        /* Ensure navbar has background immediately */
        .navbar {
            background: rgba(0, 0, 0, 0.95) !important;
            background-color: rgba(0, 0, 0, 0.95) !important;
        }
        /* Hide all content until loaded */
        body:not(.loaded) * {
            visibility: hidden;
        }
        body.loaded * {
            visibility: visible;
        }
    </style>
    
    <!-- Preload critical CSS -->
    <link rel="preload" href="{{ url_for('static', filename='css/style.css') }}" as="style">
    
    <!-- External stylesheets -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css" rel="stylesheet">
    
    <!-- Main stylesheet -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    {% if request.endpoint and 'version_control' in request.endpoint %}
    <link rel="stylesheet" href="{{ url_for('static', filename='css/version_control.css') }}">
    {% endif %}
</head>
<body>
    <div id="app">
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="/" class="nav-logo-link">
                    <span>MV+</span>
                </a>
            </div>
            <div class="nav-menu">
                <a href="/" class="nav-link {% if request.endpoint == 'home' %}active{% endif %}">
                    Home
                </a>
                <div class="nav-dropdown">
                    <span class="nav-link nav-dropdown-trigger {% if request.endpoint and 'demos' in request.endpoint %}active{% endif %}" style="cursor: pointer;">
                        Projects
                    </span>
                    <div class="nav-dropdown-content">
                        <a href="/demos" class="nav-link">Demos</a>
                    </div>
                </div>
                <a href="/about" class="nav-link {% if request.endpoint == 'about' %}active{% endif %}">
                    About
                </a>
                {% if session.user_id %}
                <div class="user-menu">
                    <span class="user-greeting">Welcome, {{ session.username }}</span>
                    <a href="/logout" class="nav-link logout-link">Logout</a>
                </div>
                {% endif %}
            </div>
        </div>
    </nav>

    <main class="main-content">
        {% block content %}{% endblock %}
    </main>

    <footer class="footer">
        <div class="footer-content">
            <div class="visitor-stats">
                <div class="stat-item">
                    <span>Total Visitors: {{ stats.total_visitors }}</span>
                </div>
                <div class="stat-item">
                    <span>Unique Visitors: {{ stats.unique_visitors }}</span>
                </div>
                <div class="stat-item">
                    <span>Countries: {{ stats.countries|length }}</span>
                </div>
            </div>
            <div class="footer-text">
                <p>&copy; 2026 MV+</p>
            </div>
        </div>
    </footer>

    </div>
    <script>
        // Maximum aggressive FOUC prevention
        (function() {
            function showContent() {
                // Use requestAnimationFrame for smooth transition
                if (window.requestAnimationFrame) {
                    requestAnimationFrame(function() {
                        document.body.classList.add('loaded');
                    });
                } else {
                    document.body.classList.add('loaded');
                }
            }
            
            // Show immediately if page is already loaded (back/forward navigation)
            if (document.readyState === 'complete' || document.readyState === 'interactive') {
                showContent();
            } else {
                // Wait for DOM ready
                if (document.readyState === 'loading') {
                    document.addEventListener('DOMContentLoaded', showContent);
                } else {
                    showContent();
                }
            }
            
            // Also wait for window load as backup
            window.addEventListener('load', function() {
                if (!document.body.classList.contains('loaded')) {
                    showContent();
                }
            });
            
            // Fallback: show after short delay (prevents indefinite hiding)
            setTimeout(function() {
                if (!document.body.classList.contains('loaded')) {
                    showContent();
                }
            }, 200);
        })();
        
        // Prevent white flash during navigation
        document.addEventListener('DOMContentLoaded', function() {
            // Ensure background is set immediately
            document.documentElement.style.backgroundColor = '#0a0a0a';
            document.body.style.backgroundColor = '#0a0a0a';
        });
    </script>
    <script src="{{ url_for('static', filename='js/main.js') }}" defer></script>
    {% block scripts %}{% endblock %}
</body>
</html>
